(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2dd7c2c1"],{"2b78":function(e,t,o){"use strict";var a=o("7a23"),c={__name:"Editor",props:["content","modelValue"],emits:["update:modelValue","update-editor"],setup(e,{emit:t}){const o=e,c=Object(a["ref"])(null),n=Object(a["computed"])(()=>new Proxy(o.modelValue,{set(e,o,a){return t("update:modelValue",{...e,[o]:a}),!0}}));return Object(a["onMounted"])(()=>{$(c.value).summernote({height:300,callbacks:{onChange:e=>{n.value.description=e}}})}),Object(a["onBeforeUnmount"])(()=>{$("#summernote").summernote("destroy")}),(e,t)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",null,[Object(a["withDirectives"])(Object(a["createElementVNode"])("textarea",{id:"summernote",type:"text",ref_key:"editor",ref:c,"onUpdate:modelValue":t[0]||(t[0]=e=>Object(a["unref"])(n).description=e)},"\r\n    ",512),[[a["vModelText"],Object(a["unref"])(n).description]])]))}};const n=c;var l=n;const s={class:"card card-primary"},r={class:"card-header"},i={class:"card-title"},d={class:"card-body"},u={class:"form-group"},m=Object(a["createElementVNode"])("label",{for:"inputName"},"Название Статьи",-1),p={class:"form-group"},b=Object(a["createElementVNode"])("label",{for:"imageInputFile"},"Загрузить изображение",-1),O={class:"input-group d-flex"},j={class:"custom-file"},g={class:"custom-file-label",for:"imageInputFile"},f={key:0},v={key:1},y={class:"form-group"},V=Object(a["createElementVNode"])("label",{for:"iconInputFile"},"Загрузить иконку",-1),E={class:"input-group d-flex"},k={class:"custom-file"},h={class:"custom-file-label",for:"iconInputFile"},N={key:0},w={key:1},B={key:0,class:"form-group"},S=Object(a["createElementVNode"])("label",{for:"exampleFormControlSelect1"},"Example select",-1),_=["selected","value"],F=Object(a["createElementVNode"])("div",{class:"card-footer bg-transparent"},[Object(a["createElementVNode"])("button",{type:"submit",class:"btn btn-primary"},"Submit")],-1);var x={__name:"AdminBaseForm",props:["titleForm","postStatuses","post","adminPostsStore"],emits:["createOrUpdatePost"],setup(e,{emit:t}){const o=e,c=Object(a["ref"])(null),n=Object(a["ref"])(null),x=Object(a["ref"])(o.post||{post_status_id:1}),P=(e,t)=>{const o=e.target.files||e.dataTransfer.files;x.value[t]=o[0],A.value[t]=o[0].name},A=Object(a["ref"])({image:x.value.image,icon:x.value.icon}),D=(e,t)=>{let o=new Blob([""],{type:"text/plain"}),a=new File([o],e||"фаил не выбран",{type:"image/jpeg",lastModified:(new Date).getTime()},"utf-8"),c=new DataTransfer;c.items.add(a),t.value.files=c.files,console.log(t.value.files[0].name)};return Object(a["onMounted"])(()=>{D(x.value.icon,c),D(x.value.image,n)}),(D,T)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",s,[Object(a["createElementVNode"])("div",r,[Object(a["createElementVNode"])("h3",i,Object(a["toDisplayString"])(e.titleForm||"Название формы"),1)]),Object(a["createElementVNode"])("form",{onSubmit:T[5]||(T[5]=Object(a["withModifiers"])(e=>t("createOrUpdatePost",x.value),["prevent"]))},[Object(a["createElementVNode"])("div",d,[Object(a["createElementVNode"])("div",u,[m,Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{"onUpdate:modelValue":T[0]||(T[0]=e=>x.value.name=e),type:"text",class:"form-control",id:"inputName"},null,512),[[a["vModelText"],x.value.name]])]),Object(a["createElementVNode"])("div",p,[b,Object(a["createElementVNode"])("div",O,[Object(a["createElementVNode"])("div",j,[Object(a["createElementVNode"])("input",{ref_key:"postImage",ref:c,onChange:T[1]||(T[1]=e=>P(e,"image")),type:"file",class:"form-control",id:"imageInputFile"},null,544),Object(a["createElementVNode"])("label",g,[A.value.image?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",v,Object(a["toDisplayString"])(A.value.image),1)):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",f,"Выберите файл"))])])])]),Object(a["createElementVNode"])("div",y,[V,Object(a["createElementVNode"])("div",E,[Object(a["createElementVNode"])("div",k,[Object(a["createElementVNode"])("input",{ref_key:"postIcon",ref:n,onChange:T[2]||(T[2]=e=>P(e,"icon")),type:"file",class:"form-control",id:"iconInputFile"},null,544),Object(a["createElementVNode"])("label",h,[A.value.icon?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",w,Object(a["toDisplayString"])(A.value.icon),1)):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",N,"Выберите файл"))])])])]),o.postStatuses?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",B,[S,Object(a["withDirectives"])(Object(a["createElementVNode"])("select",{"onUpdate:modelValue":T[3]||(T[3]=e=>x.value.post_status_id=e),class:"form-control",id:"exampleFormControlSelect1"},[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(o.postStatuses,e=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("option",{selected:x.value.post_status_id===e.id,value:e.id,key:e},Object(a["toDisplayString"])(e.name),9,_))),128))],512),[[a["vModelSelect"],x.value.post_status_id]])])):Object(a["createCommentVNode"])("",!0)]),Object(a["createVNode"])(l,{modelValue:x.value,"onUpdate:modelValue":T[4]||(T[4]=e=>x.value=e)},null,8,["modelValue"]),F],32)]))}};const P=x;t["a"]=P},"6aa0":function(e,t,o){"use strict";o.r(t);var a=o("7a23"),c=o("2b78"),n=o("91ea");const l={class:"content-wrapper"},s={class:"content-header"},r={class:"container-fluid"},i={class:"row d-flex justify-content-center"},d={class:"col-md-6 col-sm-12"};var u={__name:"create",setup(e){const t=Object(a["ref"])(null),o=Object(n["a"])();return Object(a["onMounted"])(async()=>{t.value=await o.getPostStatuses(),console.log(t)}),(e,n)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",l,[Object(a["createElementVNode"])("section",s,[Object(a["createElementVNode"])("div",r,[Object(a["createElementVNode"])("div",i,[Object(a["createElementVNode"])("div",d,[Object(a["createVNode"])(c["a"],{post:Object(a["unref"])(o).createFormData,createFormData:Object(a["unref"])(o).createFormData,postStatuses:t.value,onCreateOrUpdatePost:Object(a["unref"])(o).createOrUpdatePost},null,8,["post","createFormData","postStatuses","onCreateOrUpdatePost"])])])])])]))}};const m=u;t["default"]=m},"91ea":function(e,t,o){"use strict";o.d(t,"a",(function(){return m}));o("14d9");var a=o("be92");const c=e=>{const t=new FormData;for(const[o,a]of Object.entries(e))t.append(o,a);return t};var n=o("7a23"),l=o("6605"),s=o("a3be"),r=o("4598"),i=o("cee4"),d=o("d9c4");const u=Object(a["defineStore"])("axiosStore",()=>{const e=Object(r["a"])(),t=Object(d["a"])(),o=()=>{let o;return o=i["a"].create(),o.interceptors.response.use(e=>e,async a=>{const c=a.config;if(403===a.response.status&&!c._retry){c._retry=!0;try{const e=await t.refresh();return c.headers.Authorization="Bearer "+e.accessToken,console.log(o(c)),o(c)}catch(a){console.log(a),await e.logout();const t=Object(l["d"])();await t.push("/"),e.showLoginPage()}}return Promise.reject(a)}),o};return{setConfigAxios:o}}),m=Object(a["defineStore"])("adminPostsStore",()=>{const e=Object(r["a"])(),t=u(),o=t.setConfigAxios(),a=Object(l["d"])();let i=Object(n["ref"])(null);const d=async e=>(console.log(e),null===i.value&&(i.value=await g()),i.value.find(t=>Number(t.id)===Number(e))),m="Редактирование статей",p=["id","name","description","image","icon","post_status_id","user_id","created_at","updated_at"],b=async()=>{const t=e.getAccessTokenStorage();try{const e=await o.get(`${s["g"]}/${s["b"]}`,{headers:{Authorization:"Bearer "+t}});if(200===e.status)return e.data}catch(a){console.log(a)}},O=async t=>{const a=e.getAccessTokenStorage();console.log(t);try{const e=await o.post(`${s["g"]}/${s["a"]}`,t,{headers:{Authorization:"Bearer "+a}});200===e.status&&console.log("Статус обновлен")}catch(c){console.log(c)}},j=async t=>{const n=e.getAccessTokenStorage(),l=c(t);try{const e=await o.post(`${s["g"]}/${s["c"]}`,l,{headers:{Authorization:"Bearer "+n,"Content-Type":"multipart/form-data"}});200===e.status&&(console.log("Статья создана"),await a.push("/admin/posts"))}catch(r){console.log(r)}},g=async()=>{const t=e.getAccessTokenStorage();try{const e=await o.get(`${s["g"]}/${s["e"]}`,{headers:{Authorization:"Bearer "+t}});if(200===e.status)return i.value=e.data,e.data}catch(a){console.log(a)}},f=async t=>{const a=e.getAccessTokenStorage();console.log(t);try{const e=await o.delete(`${s["g"]}/${s["d"]}`,{data:{id:t},headers:{Authorization:"Bearer "+a}});200===e.status&&(console.log("Стаья удалена"),i.value=i.value.filter(e=>e.id!==t),console.log(i.value,"отфильтрованно"))}catch(c){console.log(c),console.log("Ошибка при удалении статьи")}};return{getPosts:g,tableHeaders:p,tableTitle:m,getByPostId:d,getPostStatuses:b,createOrUpdatePost:j,deletePost:f,posts:i,changeStatus:O}})}}]);
//# sourceMappingURL=chunk-2dd7c2c1.9ddb305e.js.map